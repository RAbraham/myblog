<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Introduction to Datalog(Bashlog) in Python. | fastpages</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Introduction to Datalog(Bashlog) in Python." />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Datalog is like SQL + Recursion. It’s derivatives have reduced the code base by 50% or more." />
<meta property="og:description" content="Datalog is like SQL + Recursion. It’s derivatives have reduced the code base by 50% or more." />
<link rel="canonical" href="/myblog/markdown/2020/02/16/introducing-mercylog.html" />
<meta property="og:url" content="/myblog/markdown/2020/02/16/introducing-mercylog.html" />
<meta property="og:site_name" content="fastpages" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-02-16T00:00:00-06:00" />
<script type="application/ld+json">
{"datePublished":"2020-02-16T00:00:00-06:00","url":"/myblog/markdown/2020/02/16/introducing-mercylog.html","@type":"BlogPosting","headline":"Introduction to Datalog(Bashlog) in Python.","dateModified":"2020-02-16T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"/myblog/markdown/2020/02/16/introducing-mercylog.html"},"description":"Datalog is like SQL + Recursion. It’s derivatives have reduced the code base by 50% or more.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/myblog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/myblog/feed.xml" title="fastpages" /><link rel="shortcut icon" type="image/x-icon" href="/myblog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/myblog/">fastpages</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/myblog/about/">About Me</a><a class="page-link" href="/myblog/search/">Search</a><a class="page-link" href="/myblog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Introduction to Datalog(Bashlog) in Python.</h1><p class="page-description">Datalog is like SQL + Recursion. It's derivatives have reduced the code base by 50% or more.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-02-16T00:00:00-06:00" itemprop="datePublished">
        Feb 16, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      7 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/myblog/categories/#markdown">markdown</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h6"><a href="#tldr">TLDR:</a></li>
<li class="toc-entry toc-h4"><a href="#datalog">Datalog</a></li>
<li class="toc-entry toc-h3"><a href="#installation">Installation</a></li>
<li class="toc-entry toc-h3"><a href="#usage">Usage</a></li>
</ul><h6 id="tldr">
<a class="anchor" href="#tldr" aria-hidden="true"><span class="octicon octicon-link"></span></a>TLDR:</h6>
<p>Datalog is like SQL + Recursion. It’s derivatives have reduced the code base by 50% or more.</p>

<h4 id="datalog">
<a class="anchor" href="#datalog" aria-hidden="true"><span class="octicon octicon-link"></span></a>Datalog</h4>
<p>Today, I would like to explore a constrained  language called Datalog. It’s a constrained form of Prolog and may not be as expressive as C++ or Python. But it’s derivatives have been known to reduce the numbers of lines of code down by 50% or more(<a href="https://dl.acm.org/citation.cfm?id=1755913.1755937">Overlog</a>, <a href="https://storage.googleapis.com/pub-tools-public-publication-data/pdf/43462.pdf">Yedalog</a>).</p>

<p>Let’s get started:</p>

<p>Datalog has a <em>minimalist syntax</em> which I love. Let’s take an example.
Suppose our data is about fathers and sons, mothers and daughters. If we had an excel sheet, we would enter the data like:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Father  Son
Aks     Bob
Bob     Cad
Yan     Zer
</code></pre></div></div>
<p>and another excel sheet for mothers and daughters:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Mother  Daughter
Mary    Marla
Marla   Kay
Jane    Zanu
</code></pre></div></div>

<p>In Datalog, we express the same data as(together):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>father('Aks', 'Bob')
father('Bob', 'Cad')
father('Yan', 'Zer')
mother('Mary', 'Marla')
mother('Marla', 'Kay')
mother('Jane', 'Zanu')
</code></pre></div></div>
<p>Here we are trying to say Aks is the father of ‘Bob’ and ‘Bob’ is the father of ‘Cad’. The datum father(‘Aks’, ‘Bob’) is called a <em><strong>fact</strong></em> i.e. it is true.</p>

<p>So Datalog can be used to express data. Not very interesting so far but a building block. These facts above can also be viewed as the existing state of the system, like we store state in files, or databases.</p>

<p>But that’s not enough. What about code? For Datalog, code are specified as <em>*rules*</em> to be applied declaratively.</p>

<p>Let’s say our program needs to find out who’s a grandfather. We could write a rule like:
‘A person X is the grandfather of Z if X is the father of Y and Y is the father of Z’. In Datalog, this rule is written as:</p>

<pre><code class="language-datalog">grandfather(X, Z) :- father(X,Y), father(Y, Z)
</code></pre>
<p>The LHS (i.e. grandfather) is known as the <code class="language-plaintext highlighter-rouge">head</code> and the RHS after the <code class="language-plaintext highlighter-rouge">:-</code> is known as the body</p>

<p>X, Y, Z are special variables called logic variables. They are different from regular variables. They are more used to represent a pattern or to link the head and the body.</p>

<p>To further understand logical variables, consider these two rules:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>grandfather<span class="o">(</span>X, Z<span class="o">)</span> :- father<span class="o">(</span>X,Y<span class="o">)</span>, father<span class="o">(</span>Y, Z<span class="o">)</span>
grandmother<span class="o">(</span>X, Z<span class="o">)</span> :- mother<span class="o">(</span>X,Y<span class="o">)</span>, mother<span class="o">(</span>Y, Z<span class="o">)</span>
</code></pre></div></div>
<p>Here the <code class="language-plaintext highlighter-rouge">X</code>, <code class="language-plaintext highlighter-rouge">Z</code> and <code class="language-plaintext highlighter-rouge">Y</code> used in <code class="language-plaintext highlighter-rouge">grandfather</code> are completely different from the <code class="language-plaintext highlighter-rouge">X</code>, <code class="language-plaintext highlighter-rouge">Y</code> and <code class="language-plaintext highlighter-rouge">Z</code> in <code class="language-plaintext highlighter-rouge">grandmother</code>. In rules, the variables only make sense <code class="language-plaintext highlighter-rouge">in</code> that single rule. So we can reuse the same logic variables in different rules without worrying that they have some logical connection.</p>

<p>The next concept is <em>*queries*</em>. How do we feed input and get back some output. 
Queries are similar to rules but without a head.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>father<span class="o">(</span>X, <span class="s1">'Aks'</span><span class="o">)</span>, mother<span class="o">(</span>Z, <span class="s1">'Aks'</span><span class="o">)</span>
 
</code></pre></div></div>
<p>we mean, find the mother and father of ‘Aks’
or</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>father<span class="o">(</span>X, <span class="s1">'Raj'</span><span class="o">)</span>, mother<span class="o">(</span>Z, <span class="s1">'Raj'</span><span class="o">)</span>
</code></pre></div></div>
<p>we mean, find the father and mother of ‘Raj’</p>

<p>Suppose, we want to say find the mother and father of all the children in the database, we make the query</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>father<span class="o">(</span>X, Y<span class="o">)</span>, mother<span class="o">(</span>Z, Y<span class="o">)</span> 
</code></pre></div></div>
<p>Datalog will link <code class="language-plaintext highlighter-rouge">Y</code> for all <code class="language-plaintext highlighter-rouge">mother</code> and <code class="language-plaintext highlighter-rouge">father</code> facts and find the mothers and fathers for a child. It will not mix up fathers and mothers :)</p>

<p>Now, If you opened a datalog interpreter and fed the above and made the following queries, you would get the results shown after the # sign</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>father(X,_) # ['Aks', 'Bob', 'Yan']
father(_,X) # ['Bob', 'Cad', 'Zer']
father(X, Y) # [('Aks', 'Bob'), ('Bob', 'Cad'), ('Yan', 'Zer')
father(X, 'Zer'), father('Zer', Y) # [] as there are no facts that match the query
grandfather(X, Y) # [('Aks', 'Cad')]
grandfather(X,_) # ['Aks']
</code></pre></div></div>
<p>Here ‘_’ is a special variable indicating that you don’t care for the result.</p>

<p>I was always interested in the Datalog syntax and it’s power. I kept delaying it until I met <a href="https://github.com/thomasrebele/bashlog">Bashlog</a>. Because, the <em>syntax of datalog is so simple</em>, it makes it <em>easy to write interpeters</em> for different targets. What Bashlog did was take Datalog syntax and convert it to bash scripts! Because, it used awk(mawk actually), sed, grep, which are tuned for high performance on Unix like platforms, it was incredibly fast in parsing big text files, comparable with all the specialized databases out there. <strong>Just Bash Scripts</strong>. It blew my mind. So if you are interested in pure Datalog, check out Bashlog</p>

<p>With Bashlog, you can run any bash like command and read that using Bashlog. Imagine there was a file(‘~/data.tsv’) with tab separated values of</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Aks Bob
Bob Cad
Yan Zer
</code></pre></div></div>

<p>We could read that data like:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>facts<span class="o">(</span>F, S<span class="o">)</span> :~ <span class="nb">cat</span> ~/data.tsv
father<span class="o">(</span>X, Y<span class="o">)</span> :- facts<span class="o">(</span>X, Y<span class="o">)</span>
</code></pre></div></div>
<p>And then we proceed the same manner like before. What’s awesome is that you can run any Unix command(e.g. <code class="language-plaintext highlighter-rouge">ls -l</code>) as long as it returns an output of tab separated values.</p>

<p>But I wanted to  use Datalog in my day to day programming. I wanted to see if I could use and leverage Datalog along with Python. Some benefits of Datalog in Python are:</p>

<ul>
  <li>Modularity. How do we abstract out patterns in our rules and facts.</li>
  <li>Possible access to exisitng rich source of libraries.</li>
</ul>

<p>So I built <a href="https://github.com/RAbraham/mercylog">Mercylog</a> in Python.</p>

<p>So let’s translate the above rules to Mercylog syntax.</p>

<h3 id="installation">
<a class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h3>

<p>If you are using the Bashlog variant,</p>
<ul>
  <li>then you need Java 8 already installed</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/RAbraham/mercylog_tutorial.git
<span class="nb">cd </span>mercylog_tutorial
python3 <span class="nt">-m</span> venv venv
<span class="nb">source </span>venv/bin/activate
pip <span class="nb">install</span> <span class="nt">-r</span> requirements.txt
python tutorial.py
</code></pre></div></div>
<p>That should print</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span><span class="s1">'Aks'</span><span class="o">]</span>
<span class="o">[</span><span class="s1">'Mary'</span><span class="o">]</span>
</code></pre></div></div>

<p>Read below on the explanation and make tweaks if you want and run <code class="language-plaintext highlighter-rouge">python tutorial.py</code> again.</p>

<h3 id="usage">
<a class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">mercylog</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">mercylog</span><span class="p">.</span><span class="n">BashlogV1</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1"># father('Aks', 'Bob')
# father('Bob', 'Cad')
# father('Yan', 'Zer')
# mother('Mary', 'Marla')
# mother('Marla', 'Kay')
# mother('Jane', 'Zanu')
</span>
<span class="n">father</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">relation</span><span class="p">(</span><span class="s">'father'</span><span class="p">)</span>
<span class="n">mother</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">relation</span><span class="p">(</span><span class="s">'mother'</span><span class="p">)</span>
<span class="n">facts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">father</span><span class="p">(</span><span class="s">'Aks'</span><span class="p">,</span> <span class="s">'Bob'</span><span class="p">),</span>
    <span class="n">father</span><span class="p">(</span><span class="s">'Bob'</span><span class="p">,</span> <span class="s">'Cad'</span><span class="p">),</span>
    <span class="n">father</span><span class="p">(</span><span class="s">'Yan'</span><span class="p">,</span> <span class="s">'Zer'</span><span class="p">),</span>
    <span class="n">mother</span><span class="p">(</span><span class="s">'Mary'</span><span class="p">,</span> <span class="s">'Marla'</span><span class="p">),</span>
    <span class="n">mother</span><span class="p">(</span><span class="s">'Marla'</span><span class="p">,</span> <span class="s">'Kay'</span><span class="p">),</span>
    <span class="n">mother</span><span class="p">(</span><span class="s">'Jane'</span><span class="p">,</span> <span class="s">'Zanu'</span><span class="p">),</span>
<span class="p">]</span> 

</code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># grandfather(X, Z) :- father(X,Y), father(Y, Z)
</span><span class="n">grandfather</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">relation</span><span class="p">(</span><span class="s">'grandfather'</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">variables</span><span class="p">(</span><span class="s">'X'</span><span class="p">,</span> <span class="s">'Y'</span><span class="p">,</span> <span class="s">'Z'</span><span class="p">)</span> 
<span class="n">grandfather</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">[</span><span class="n">father</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">father</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)]</span>
</code></pre></div></div>

<p>While in Datalog, you don’t have to explicitly state the variables and the relation, as it is baked in to the language,  in our library in Python, we need to (e.g. X, Y, Z and father, grandfather)</p>

<p>Making a query in python has the following syntax</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">m</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">facts</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
</code></pre></div></div>
<p>A concrete example would be:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">m</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">facts</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="n">grandfather</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">))</span> <span class="c1"># which gives [('Aks', 'Cad')]
</span><span class="n">m</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">facts</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="n">father</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">_</span><span class="p">))</span> <span class="c1"># ['Aks', 'Bob', 'Yan']
</span><span class="n">m</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">facts</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span><span class="n">father</span><span class="p">(</span><span class="n">_</span><span class="p">,</span><span class="n">X</span><span class="p">))</span> <span class="c1"># ['Bob', 'Cad', 'Zer']
</span><span class="n">m</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">facts</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span><span class="n">father</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">))</span> <span class="c1"># [('Aks', 'Bob'), ('Bob', 'Cad'), ('Yan', 'Zer')
</span><span class="n">m</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">facts</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="n">granfather</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">_</span><span class="p">))</span> <span class="c1"># ['Aks']
</span></code></pre></div></div>

<p>Creating this DSL in python gives us some unique benefits. For e.g if we had these two relations</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">paternal_grandfather</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">relation</span><span class="p">(</span><span class="s">'paternal_grandfather'</span><span class="p">)</span>
<span class="n">maternal_grandmother</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">relation</span><span class="p">(</span><span class="s">'maternal_grandmother'</span><span class="p">)</span>
<span class="n">father</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">relation</span><span class="p">(</span><span class="s">'father'</span><span class="p">)</span>
<span class="n">mother</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">relation</span><span class="p">(</span><span class="s">'mother'</span><span class="p">)</span>

<span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">variables</span><span class="p">(</span><span class="s">'X'</span><span class="p">,</span> <span class="s">'Y'</span><span class="p">,</span> <span class="s">'Z'</span><span class="p">)</span>
<span class="n">rules</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">paternal_grandfather</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">[</span><span class="n">father</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">father</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)],</span>
    <span class="n">maternal_grandmother</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">[</span><span class="n">mother</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">mother</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)]</span>
<span class="p">]</span> 

</code></pre></div></div>
<p>If you notice, the rule for <code class="language-plaintext highlighter-rouge">paternal_grandfather</code> and <code class="language-plaintext highlighter-rouge">maternal_grandmother</code> are very similar. I could perhaps encapsulate that into a function. I’ll use the word <code class="language-plaintext highlighter-rouge">transitive</code> though I believe it is incorrect to use it.. but I don’t know what to call this for now. Rewriting the above code:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">def</span> <span class="nf">transitive</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">clause</span><span class="p">):</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">variables</span><span class="p">(</span><span class="s">'X'</span><span class="p">,</span> <span class="s">'Y'</span><span class="p">,</span> <span class="s">'Z'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">head</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">[</span><span class="n">clause</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">clause</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)]</span>

<span class="n">paternal_grandfather</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">relation</span><span class="p">(</span><span class="s">'paternal_grandfather'</span><span class="p">)</span>
<span class="n">maternal_grandmother</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">relation</span><span class="p">(</span><span class="s">'maternal_grandmother'</span><span class="p">)</span>
<span class="n">father</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">relation</span><span class="p">(</span><span class="s">'father'</span><span class="p">)</span>
<span class="n">mother</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">relation</span><span class="p">(</span><span class="s">'mother'</span><span class="p">)</span>


<span class="n">rules</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">transitive</span><span class="p">(</span><span class="n">paternal_grandfather</span><span class="p">,</span> <span class="n">father</span><span class="p">),</span>
    <span class="n">transitive</span><span class="p">(</span><span class="n">maternal_grandmother</span><span class="p">,</span> <span class="n">mother</span><span class="p">)</span>
<span class="p">]</span>     
</code></pre></div></div>

<p>In this way, using Python, we have modularized a pattern using the <code class="language-plaintext highlighter-rouge">transitive</code> function.</p>

<p>Let’s recap the benefits of Mercylog</p>
<ul>
  <li>Simple Syntax. All you need to know is facts and rules. Because of such simplicity, it is also easy to build compilers for it.</li>
  <li>Expressive. Rules give a powerful mechanism</li>
  <li>Declarative. Like SQL but more expressive. So we can optimize it’s engines without affecting the code</li>
</ul>

<p>I’ll continue to update you with my future learnings!</p>


  </div><a class="u-url" href="/myblog/markdown/2020/02/16/introducing-mercylog.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/myblog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/myblog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/myblog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" title="fastai"><svg class="svg-icon grey"><use xlink:href="/myblog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/myblog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
